image: golang:1.11-alpine

stages:
    - test

before_script:
  - mkdir -p /go/src/ehw2018.io/greetings-server/
  - cp -fr ../repo /go/src/ehw2018.io/greetings-server/
  - cd /go/src/ehw2018.io/greetings-server/repo

exec_test:
    stage: test
    tags:
        - test
    script:
        - apk add make
        - apk add git
        - go get -u github.com/golang/dep/cmd/dep
        - make depinit
        - make bin/greetings-server
        - make test
